<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mathéria - Habilidades do EM </title>
  <style>
    body {
      background: linear-gradient(to bottom, #2e8b57, #1c1c1c);
      color: white;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1000px;
      margin: auto;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
      margin-bottom: 10px;
    }
    .skill-box {
      background-color: #333;
      border-radius: 10px;
      padding: 15px;
      margin: 10px 0;
    }
    .skill-name {
      font-size: 1.2em;
      margin-bottom: 5px;
    }
    .level-bar {
      background-color: #555;
      border-radius: 5px;
      overflow: hidden;
    }
    .level-bar-fill {
      height: 20px;
      background-color: #4caf50;
      width: 0%;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #777;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #444;
    }
    .profile-input {
      margin: 20px auto;
      text-align: center;
    }
    .profile-input textarea {
      width: 90%;
      height: 100px;
      padding: 10px;
      font-size: 14px;
    }
    .profile-input button {
      margin-top: 10px;
      padding: 10px 20px;
      background-color: #4caf50;
      border: none;
      color: white;
      font-weight: bold;
      border-radius: 5px;
      cursor: pointer;
    }
    .profile-section {
      margin-top: 30px;
    }
    .profile {
      background-color: #222;
      border-radius: 10px;
      padding: 15px;
      margin: 10px 0;
    }
    .profile h3 {
      margin: 0 0 10px 0;
    }
    .schoolxp-box {
      background-color: #444;
      padding: 10px;
      margin-top: 10px;
      border-radius: 8px;
    }
    .hidden {
      display: none;
    }
    .popup {
      background: #333;
      border: 2px solid #4caf50;
      padding: 20px;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      border-radius: 10px;
      z-index: 1000;
    }
    .popup input {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
    }
    .popup button {
      margin-top: 10px;
      padding: 10px;
      width: 100%;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Mathéria</h1>
    <h2>Sistema de Skills do Ensino Médio</h2>

    <div class="profile-input">
      <h3>Comando</h3>
      <textarea id="codeInput" placeholder="Digite um comando ou cole o código do perfil"></textarea><br>
      <button onclick="interpretarCodigo()">Executar</button>
    </div>

    <div class="profile-section" id="profiles"></div>

    <h2>Tabela de XP por Nível</h2>
    <table>
      <thead>
        <tr><th>Nível</th><th>XP Necessário</th><th>XP Total</th></tr>
      </thead>
      <tbody>
        <tr><td>1</td><td>50</td><td>50</td></tr>
        <tr><td>2</td><td>60</td><td>110</td></tr>
        <tr><td>3</td><td>72</td><td>182</td></tr>
        <tr><td>4</td><td>86</td><td>268</td></tr>
        <tr><td>5</td><td>103</td><td>371</td></tr>
        <tr><td>...</td><td>...</td><td>...</td></tr>
        <tr><td>50</td><td>379184</td><td>2274835</td></tr>
      </tbody>
    </table>
  </div>

  <div id="popupXP" class="popup hidden">
    <h3>Definir School XP</h3>
    <input type="text" id="nomeAluno" placeholder="Nome do aluno">
    <input type="number" id="valorXP" placeholder="Valor de XP">
    <button onclick="salvarXP()">Salvar</button>
    <button onclick="fecharPopup()">Fechar</button>
  </div>

  <script>
    let alunos = [
      {
        nome: "Davi M",
        skills: {
          "Matemática": 12,
          "Física": 0,
          "Geografia": 0,
          "Biologia": 0,
          "Qúimica": 0,
          "Produção de Texto": 0,
          "Projeto de Vida": 0,
          "Projeto Integrador": 0,
          "Por trás do Texto": 0,
          "Grandezas Físicas do Cotidiano": 0,
          "Conversões e Logarítmo": 0,
          "Educação Física": 0,
          "Artes": 0,
          "Educação Financeira": 0,
          "Português": 0,
          "Literatura": 0,
          "Zoom In": 0
        },
        schoolXP: 0
      },
      {
        nome: "Isaque",
        skills: {
          "Matemática": 0,
          "Física": 0,
          "Geografia": 0,
          "Biologia": 0,
          "Qúimica": 0,
          "Produção de Texto": 0,
          "Projeto de Vida": 0,
          "Projeto Integrador": 0,
          "Por trás do Texto": 0,
          "Grandezas Físicas do Cotidiano": 0,
          "Conversões e Logarítmo": 0,
          "Educação Física": 0,
          "Artes": 0,
          "Educação Financeira": 0,
          "Português": 0,
          "Literatura": 0,
          "Zoom In": 0
        },
        schoolXP: 0
      }
    ];

    function interpretarCodigo() {
      const input = document.getElementById('codeInput').value.trim();
      let profilesHTML = '';

      if (input.toLowerCase() === 'setschoolxp') {
        document.getElementById('popupXP').classList.remove('hidden');
        return;
      }

      const lines = input.split('\n');
      alunos.forEach(aluno => {
        // Verificar se o nome corresponde ao aluno
        if (lines.some(line => JSON.parse(line).nome === aluno.nome)) {
          profilesHTML += gerarHTMLAluno(aluno);
        }
      });

      if (!profilesHTML) {
        profilesHTML = "<p style='color:red;'>Aluno não encontrado ou dados incompletos!</p>";
      }

      document.getElementById('profiles').innerHTML = profilesHTML;
    }

    function gerarHTMLAluno(data) {
      const nome = data.nome;
      const skills = data.skills || {};
      const schoolXP = data.schoolXP || 0;
      let skillHTML = '';

      for (let materia in skills) {
        const nivel = skills[materia];
        const porcentagem = Math.min((nivel / 50) * 100, 100);
        skillHTML += `
          <div class="skill-box">
            <div class="skill-name">${materia} (Nível ${nivel})</div>
            <div class="level-bar">
              <div class="level-bar-fill" style="width: ${porcentagem}%;"></div>
            </div>
          </div>
        `;
      }

      return `
        <div class="profile">
          <h3>${nome}</h3>
          <div class="schoolxp-box">School XP: ${schoolXP}</div>
          ${skillHTML}
        </div>
      `;
    }

    function salvarXP() {
      const nome = document.getElementById('nomeAluno').value;
      const valor = parseInt(document.getElementById('valorXP').value);

      for (let aluno of alunos) {
        if (aluno.nome === nome) {
          aluno.schoolXP = valor;
        }
      }

      const htmlAtualizado = alunos.map(gerarHTMLAluno).join('');
      document.getElementById('profiles').innerHTML = htmlAtualizado;
      fecharPopup();
    }

    function fecharPopup() {
      document.getElementById('popupXP').classList.add('hidden');
    }

    // Renderiza os usuários ao inicializar
    document.addEventListener("DOMContentLoaded", function() {
      const profilesHTML = alunos.map(gerarHTMLAluno).join('');
      document.getElementById('profiles').innerHTML = profilesHTML;
    });
  </script>
</body>
</html>
